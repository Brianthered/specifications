= C2PA Security Considerations
:docinfo: shared
:doctype: book
:title: C2PA Security Considerations
:revdate: {docdate}
:revnumber: 0.1
:revremark: Draft (0.1)
:version-label!: 
:toc: left
:sectnums:
:sectnumlevels: 5 
:source-highlighter: rouge
:pdf-version: 1.7
:xrefstyle: full
:title-logo-image: output/images/c2pa-hero.svg

// license
====
image::images/CCby4.png[Creative Commons License, align=center, link="http://creativecommons.org/licenses/by/4.0/"]

[.text-center]
This work is licensed under a http://creativecommons.org/licenses/by/4.0/[Creative Commons Attribution 4.0 International License].
====

// Table of Contents
toc::[]

== Introduction

This document provides information security considerations for technology described in the https://c2pa.org/public-draft[C2PA core specification]. It complements security-related content in other C2PA documents. This document includes:

* A summary of relevant security features of C2PA technology
* Security considerations for practical use of C2PA technology
* Threats to C2PA technology and respective treatment of those threats, including countermeasures

Analysis in this document does not assess security risk or likelihoods associated with threats or outcomes. These may vary based on a number of factors, such as the context in which C2PA technology is deployed and changes in the threat landscape. However, content in this document may be helpful in developing security risk and likelihood assessments related to use of C2PA technology.

[IMPORTANT]
====
Content in this document is non-normative and does not specify requirements for complying with the C2PA specification.
====

While the C2PA endeavors to develop and maintain a comprehensive threat model and security considerations for C2PA technology, we expect this work to be ongoing as technology develops and the threat landscape evolves.

[IMPORTANT]
====
This document is an incomplete work in progress. Refer to the https://c2pa.org/public-draft/[latest C2PA core specification] for up-to-date information.
====

=== Threat modeling process overview

The C2PA builds security into our designs as they are being developed, but also expects that security design and threat modeling will continue as the system, ecosystem, and threat landscape evolve.

To this end, the C2PA uses a focused threat modeling process to support development of a strong security and privacy design. Outcomes of the effort directly support development of documentation about explicit threats and security considerations while also facilitating security-oriented thinking throughout the design process.

The threat modeling process combines synchronous (i.e., live) threat modeling sessions with focused groups of Subject Matter Experts (SMEs) in the asynchronous development of content.  The number of attendees in each synchronous session is kept small to promote efficient discussions, but all members of the C2PA have the opportunity to participate via either modality.

Like other security activities, we expect our threat modeling process to evolve with the C2PA ecosystem. Process documentation is considered a guide rather than a strict directive on how threat modeling works within the C2PA.

NOTE: In this document _asset_ refers to C2PA assets and not https://cheatsheetseries.owasp.org/cheatsheets/Threat_Modeling_Cheat_Sheet.html#define-and-evaluate-your-assets[conventional threat model assets].

==== References

A variety of references and experiences are used to inform threat modeling and related security activities for the C2PA. This section provides a subset of public documents for reference.

* https://datatracker.ietf.org/doc/html/rfc3552#page-26[IETF on security considerations]
* https://datatracker.ietf.org/doc/html/rfc6973#section-7[IETF on privacy considerations (guidelines)]
* https://www.w3.org/TR/security-privacy-questionnaire/[W3C security and privacy self-review questionnaire]
* https://datatracker.ietf.org/doc/html/rfc6819[OAuth2 threat model (example)]
* https://shostack.org/books/threat-modeling-book[Threat Modeling: Designing for Security]
* https://owasp.org/www-community/Threat_Modeling[OWASP Threat Modeling]
* https://www.microsoft.com/en-us/securityengineering/sdl/threatmodeling[Microsoft Threat Modeling]

== Security features

This section summarizes C2PA features that support the xref:_security_model[security model] specified later in this document. The https://c2pa.org/public-draft[C2PA core specification] should be considered the canonical reference for C2PA features. It supersedes summaries provided here.

=== Provenance model

C2PA enables consumers to reason about asset provenance. C2PA specifies a model for asset provenance based on the following definitions.

Provenance::
The logical concept of understanding the history of an _asset_ and its interaction with _actors_ and other _assets_, as represented by the _provenance data_.

Provenance data::
The set of _manifests_ for an _asset_ and, in the case of a _composed asset_, its ingredients.

Assertion::
A data structure which represents a statement asserted by an _actor_ concerning the _asset_. This data is a part of the _manifest_.

Claim::
A digitally signed and tamper-evident data structure that references a set of _assertions_ by one or more _actors_, concerning an _asset_, and the information necessary to represent the _content binding_. If any _assertions_ were redacted, then a declaration to that effect is included. This data is a part of the _manifest_.

Claim signature::
The digital signature on the _claim_ using the private key of an _actor_. The claim signature is a part of the _manifest_.

Manifest::
The set of information about the _provenance_ of an _asset_ based on the combination of one or more _assertions_ (including _content bindings_), a single _claim_, and a _claim signature_. A manifest can either be embedded into an _asset_ or be external to its _asset_.

Origin::
The _manifest_ in the _provenance data_ which represents the method or device that initially created the _asset_.

Active Manifest::
The last manifest in the list of manifests which is the one with the set of _content bindings_ that are able to be validated.

image::images/C2PA_Manifest.svg[]

=== Trust model

The basis of making trust decisions in C2PA, its Trust Model, is the identity of the actor associated with the cryptographic signing key used to sign the claim in the active manifest. The identity of a signatory is not necessarily a human actor, and the identity presented may be a pseudonym, completely anonymous, or pertain to a service or trusted hardware device with its own identity, including an application running inside such a service or trusted hardware. C2PA manifests can be validated indefinitely regardless of whether the cryptographic credentials used to sign its contents are later expired or revoked.

In addition to identity, C2PA leverages trusted timestamps to ensure the correctness of signing and revocation processes. A benefit of this approach is that revocation status can be optionally obtained when claims are generated (rather than when consumed), and revocation can be applied to subsets of signatures by timestamp. See the https://c2pa.org/public-draft/#_trust_model[Trust Model section of the specification] for more details.

=== Claim signatures

C2PA uses cryptographic signatures to ensure that any tampering of the asset provenance can be detected. C2PA does not offer any protection against the xref:_threat_stripping_c2pa_manifests[complete removal of C2PA manifests from assets], but the design does aim to prevent any unauthorized tampering of either the digital asset content or the C2PA manifests themselves. 

Details on supported cryptographic hashing and signature schemes, as well as format details, are covered in the https://c2pa.org/public-draft/#_cryptography[Cryptography section]. As noted there, the C2PA maintains lists of supported algorithms and types that aim to adhere to cryptographic and compatibility best practices.

Detail on how signing credentials relate to identity are included in the https://c2pa.org/public-draft/#_trust_model[Trust Model section of the specification]. The https://c2pa.org/public-draft/#_validation[Validation section] provides details on validating claims, which includes validating signatures.

=== Content bindings

Content bindings associate provenance data in C2PA manifests with assets.

In the context of a C2PA manifest, hard bindings provide a strict cryptographic binding between provenance and an asset; they aim to provide some useful guarantees against tampering. Soft bindings provide less strict binding between the provenance and an asset. They may associate C2PA provenance with multiple assets, and vice versa.

C2PA manifests may be embedded in assets or it may exist externally, such as when served as part of the same HTTP connection.  In addition, C2PA manifests may also be decoupled from assets, enabling the C2PA manifest to be retrieved and processed separately from the asset.

Details on C2PA bindings are included in the https://c2pa.org/public-draft/#_binding_to_content[binding to content section of the C2PA core specification].

=== Validation

Validation checks provenance claim signatures and performs supporting operations. The validation algorithm is described in the https://c2pa.org/public-draft/#_validation[validation section of the C2PA specification].

=== Protection of personal information

C2PA provides features that can be used to protect confidentiality of personal information while still establishing the provenance of an asset.

* Anonymous or pseudo-anonymous identities may be used for signing claims.
* Assertions that may contain sensitive information can be removed via https://c2pa.org/public-draft/#_redaction_of_assertions[redaction].
* Assertions can be customized for specific workflows, such as where specific information is required to remain encrypted end-to-end.
* Manifests may include https://c2pa.org/public-draft/#_w3c_verifiable_credentials[W3C Verifiable Credentials].

Note that confidentiality of personal information and other privacy-related concerns are addressed in the Harms Considerations document.

== Security model

The C2PA security model is focused on security of C2PA provenance data. While attackers may aim to compromise the security of other aspects of the system, this model assumes the pivotal goal is compromise of C2PA provenance. 

The following principles should hold:

Integrity::

Attempts to compromise the integrity of C2PA provenance data associated with a respective asset will be detected upon validation. This includes all data stored within C2PA manifests.
+
For embedded manifests, malicious association of an existing manifest with a differing asset is also tamper-evident. In addition, the following actions are tamper-evident for all manifests:

* Manifest: Malicious modification of an active or ingredient manifest.
* Claims and claim signatures: Addition, removal, or modification of an existing claim in an existing manifest.
* Assertions: Addition, removal, or modification of assertions in the assertion store referenced by an existing claim.


Availability::

An attacker may degrade availability of C2PA data, but C2PA should provide means to mitigate this impact.
+
For example: An attacker may strip manifests from C2PA-enabled assets altogether. Guidance is provided on how to mitigate the impact of this scenario.

Confidentiality::

C2PA does not specify confidentiality properties for assets themselves, provenance model primitives, private address books, or cryptographic secrets.
+
* They may be kept confidential via other means. For example by transmitting assets via TLS. However, enforcing this confidentiality is considered
out-of-scope for this specification.

* Some private data, such as claim signing keys or private address books, must adhere to conventional confidentiality principles.
Compromise of this private data could lead to indirect violation of other principles specified in this section. Enforcing confidentiality of this adjacent private data is considered out-of-scope for this specification.

* C2PA does not specify Digital Rights Management (DRM) technology.

* C2PA does not specify guarantees of confidentiality of personal information.

** However, C2PA provides features that can be used to protect confidentiality of personal information (xref:_protection_of_personal_information[summary])
** Confidentiality of personal information and other privacy-related concerns are addressed in the TODO[Harms Considerations document].
+
In general, these assertions are achieved through application of the C2PA trust model to the claim generation process, and corresponding checks in the validation process.

== Threat model

include::Threat_Model.adoc[]

